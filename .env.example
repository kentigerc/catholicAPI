# Copy this file to .env.local (or .env.development or .env.production)
# Do not commit .env.local to version control, as it may contain sensitive information.
# In production, API_BASE_PATH must be set; other variables are optional.
# In development, the variables are used to launch the API and the Unit Test server.

# valid values: development, test, staging, production
APP_ENV=development

##
# WebSocket Configuration
# Set the same value for WS_PORT in the Unit Test frontend project folder
# See: https://github.com/Liturgical-Calendar/LiturgicalCalendarAPI/blob/development/public/LitCalTestServer.php
##
WS_PORT=8080
# Maximum concurrent HTTP requests for WebSocket server (default: 10 in production, 4 in development)
# Reduce this on memory-constrained servers to prevent overwhelming the API
WS_MAX_CONCURRENCY=10

##
# API Configuration
# These variables control where the API launches and how the Unit Test server connects to it
##
API_PROTOCOL=http
API_HOST=localhost
# This determines the port on which 'composer start' will launch the API
# It also instructs the Unit Test server on which port to look for the API
# If launching from VSCode tasks, set the same value in tasks.json
API_PORT=8000
# API Base Path - required in production or if dev server is not launched from public folder
# The API cannot infer whether its path is `/api/` or `/api/{version}/`
# In local development, leave empty (API runs at root)
# In production, typically /api/dev or /api/v5
API_BASE_PATH=

##
# JWT Authentication Configuration
# Generate a secure 64-character hex string: php -r "echo bin2hex(random_bytes(32));"
##
JWT_ALGORITHM=HS256
JWT_EXPIRY=3600
JWT_REFRESH_EXPIRY=604800
# IMPORTANT: Change to a strong random string in production (minimum 32 characters)
JWT_SECRET=change-this-to-a-secure-random-string-in-production-minimum-32-chars

##
# Admin User Credentials
# Generate password hash: php -r "echo password_hash('your-password', PASSWORD_ARGON2ID);"
# In dev/test: falls back to default password "password" if hash is missing/invalid
# In staging/production: a valid ADMIN_PASSWORD_HASH is required
##
ADMIN_USERNAME=admin
ADMIN_PASSWORD_HASH=CHANGE_ME_GENERATE_WITH_password_hash

##
# CORS Configuration
# Comma-separated list of allowed origins for credentialed CORS requests (auth endpoints)
# Use '*' to allow all origins (not recommended for production with cookie-based auth)
# Example: https://example.com,https://admin.example.com
##
CORS_ALLOWED_ORIGINS=*

##
# Rate Limiting for Authentication
# Protects against brute-force attacks on the /auth/login endpoint
##
# Maximum failed login attempts before lockout (default: 5)
RATE_LIMIT_LOGIN_ATTEMPTS=5
# Time window in seconds for tracking attempts (default: 900 = 15 minutes)
RATE_LIMIT_LOGIN_WINDOW=900
# Path for rate limit data files (default: system temp directory)
# RATE_LIMIT_STORAGE_PATH=/var/lib/litcal/rate_limits

##
# HTTPS Enforcement
# In staging/production, auth endpoints require HTTPS by default
# Set to "false" to disable (e.g., if TLS is terminated at load balancer)
# When using a reverse proxy, ensure it sets X-Forwarded-Proto header
##
HTTPS_ENFORCEMENT=true

##
# Redis Configuration (for WebSocket server caching)
# Uses Redis (or APCu fallback) for caching
# Configure either Unix socket OR TCP connection (socket takes precedence)
# If not configured, defaults to TCP 127.0.0.1:6379
##
# Unix socket connection (recommended for local Redis):
# REDIS_SOCKET=/var/run/redis/redis.sock
# TCP connection:
# REDIS_HOST=127.0.0.1
# REDIS_PORT=6379
